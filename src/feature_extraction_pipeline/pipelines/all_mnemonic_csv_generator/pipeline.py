from kedro.pipeline import Pipeline, node, pipeline
from .nodes import get_data_from_bucket, trigger_all_mnemonic_call

def create_pipeline(**kwargs) -> Pipeline:
    return pipeline(
        [
            node(
                func=get_data_from_bucket,
                inputs=["params:minio_url", "params:minio_alias", "params:admin", "params:password", "params:bucket_name", "params:save_directory"],
                outputs="get_images_from_bucket_ok",
                name="get_data_from_bucket_node",
            ),
            node(
                func=trigger_all_mnemonic_call,
                inputs=["params:all_mnemonic_csv_input_path", "params:all_mnemonic_csv_output_path"],
                outputs="trigger_all_mnemonic_call_ok",
                name="trigger_all_mnemonic_call_node",
            ),
        ]
    )
